---
layout: post
title: Gradle and Flavor Groups
date: '2013-11-10T14:08:00.000-08:00'
author: Daniel Drummond
tags:
- flavorgroup
- gradle
- group
- android studio
- flavor groups
- flavor
- multi flavor
- android
- build
- flavorgroups
modified_time: '2013-11-10T15:07:52.772-08:00'
blogger_id: tag:blogger.com,1999:blog-531773883684728825.post-7091234993622628381
blogger_orig_url: http://apporia.blogspot.com/2013/11/gradle-and-flavor-groups.html
---

One of the most useful tools that the Android plugin for Gradle gives us is flavors. &nbsp;Flavors allow us to create builds of the same app, with some slight differences. &nbsp;This is useful for so many different things, e.g. free and paid versions, where one contains ads, and one does not, or creating a white-label app, and applying branding for different clients.<br />But how can we handle cases where we have multiple flavor dimensions? &nbsp;For example, combining the two examples above, i.e. creating a white-label app that comes in paid and free versions? Luckily we don't have to create a flavor for each of these, and manually track what resources and code is in each directory, or write scripts to do this for us. &nbsp;The Android Gradle plugin provides a feature called flavor groups (see the&nbsp;<a href="http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Multi-flavor-variants" target="_blank">user docs</a>&nbsp;for the official documentation).<br /><h3>How do they work?</h3><div>Firstly you define the flavor groups themselves. &nbsp;Each flavor group represents a dimension. &nbsp;As an example I am going to use a deck of cards. &nbsp;Each card has two dimensions (or properties): a card number, and a suit. So our build.gradle will define two flavor groups:</div><div><br /></div><div><pre>buildscript {<br />    ...<br />    android {<br />        ...<br />        flavorGroups "suit", "number"<br />        ...<br />    }<br />    ...<br />}<br /></pre></div><div><br /></div>The next thing we need to do is define the flavors for each dimension. &nbsp;In this example the flavors for suit will be clubs, spades, hearts and diamonds. &nbsp;The flavors for the card number will be ace, two, three, four, five, six, seven, eight, nine, ten, jack, queen, king. &nbsp;These flavors need to be defined, and marked with which flavor group they belong to. &nbsp;The snippet below has been shortened.<br /><br /><pre>buildscript {<br />    ...<br />    android {<br />        ...<br />        flavorGroups "suit", "number"<br /><br />        productFlavors {<br /><br />            //Number flavors<br />            ace {<br />                flavorGroup "number"<br />            }<br /><br />            two {<br />                flavorGroup "number"<br />            }<br />            ...<br />            queen {<br />                flavorGroup "number"<br />            }<br /><br />            king {<br />                flavorGroup "number"<br />            }<br /><br /><br />            //Suits flavours<br />            clubs {<br />                flavorGroup "suit"<br />            }<br /><br />            spades {<br />                flavorGroup "suit"<br />            }<br /><br />            diamonds {<br />                flavorGroup "suit"<br />            }<br /><br />            hearts {<br />                flavorGroup "suit"<br />            }<br />        }<br />    }<br />    ...<br />}<br /></pre><br />The result of this is an apk is generated for each combination of the flavor groups. In this case this results in 4 suits x 13 numbers = 52 apks (Note this took 24 minutes to build on my slow laptop). That was for the debug build variants only. If I had a signing config in there, and ran gradle assemble I would end up with 156 apks :-).<br />For this toy example, I created a layout with two ImageViews: a suit image and a number image. I then created the 4 suit images, and 13 card images for populating these image views, and placed them in the correct folders for the 17 flavors. <br /><h3>Anything else I should know?</h3><div>The order of definition of flavor groups matters. This defines the priority for overriding resources. &nbsp;In the above case suit has a greater priority than number, which has a greater priority than the defaults (in the main sourceset).&nbsp;</div><div><br /></div><div><br /></div><div>The code for this example can be found on&nbsp;<a href="https://github.com/dmdrummond/Flavor-Groups-Example" target="_blank">github.com/dmdrummond/Flavor-Groups-Example</a>.</div>